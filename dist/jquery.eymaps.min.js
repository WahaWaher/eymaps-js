/**
 * jQuery.eyMaps
 * Version: 1.0.0
 * Repo: https://github.com/WahaWaher/eymaps-js
 * Author: Sergey Kravchenko
 * Contacts: wahawaher@gmail.com
 * License: MIT
 */

!function($){function randInt(t,e){var a=t-.5+Math.random()*(e-t+1);return a=Math.round(a)}var methods={init:function(options){var defaults=$.extend(!0,{api:"https://api-maps.yandex.ru/2.1/?lang=ru_RU",zoomAfter:"click",event:!1,placemarkDefaults:{},beforeInit:function(){},beforeLoad:function(){},afterLoad:function(){},map:{center:[],zoom:5},placemark:[{geometry:[],properties:{},options:{}}]},$.fn.eyMaps.defaults);this.each(function(){var $ths=$(this);if(1==$ths.data("_init"))return!1;$ths.data("defaults",defaults),$ths.data("options",options);var data=$ths.attr("data-eymaps");"object"!=typeof(data=eval("("+data+")"))&&(data={}),$ths.data("settings",$.extend(!0,{},defaults,options,data));var sets=$ths.data("settings");sets.beforeInit.call($ths,sets),$ths.addClass("eymaps"),sets._mid,$ths.attr("id")?sets._mid=$ths.attr("id"):(sets._mid="eymaps-mid-"+randInt(0,1e5),$ths.attr("id",sets._mid)),sets._nsid=randInt(1e7,1e8),sets.event?$ths.one(sets.event+".eym-"+sets._nsid,function(){methods.load.call($ths)}):methods.load.call($ths),$ths.data("_init",!0)})},destroy:function(){if(!$(this).data("_init"))return!1;var t=$(this),e=t.data("settings");return t.attr("id")==e._mid&&t.attr("id").match(/-mid-/gim)&&t.removeAttr("id"),t.removeClass("eymaps").off(e.event+".eym-"+e._nsid).removeData().children().remove(),this},reinit:function(t){var e=$(this),a=(e.data("settings"),e.data("options"));return methods.destroy.call(e),t&&"object"==typeof t?methods.init.call(e,t):methods.init.call(e,a),this},load:function(){function t(){null==e.get(0).firstChild&&ymaps.ready(function(){a.beforeLoad.call(e,a);var t=new ymaps.Map(a._mid,a.map);a.zoomAfter&&(t.behaviors.disable("scrollZoom"),t.container._parentElement.addEventListener(a.zoomAfter,function(){t.behaviors.isEnabled("scrollZoom")||t.behaviors.enable("scrollZoom")})),"object"==typeof a.placemark[0].geometry&&2===a.placemark[0].geometry.length&&$.each(a.placemark,function(e,s){var o=new ymaps.Placemark(s.geometry,s.properties,$.extend({},a.placemarkDefaults,s.options));t.geoObjects.add(o),option1={}}),a.afterLoad.call(e,a)})}var e=this,a=e.data("settings");if(!a)return!1;var s=$('script[src="'+a.api+'"]');return s.length&&"object"==typeof ymaps?t():s.length&&"object"!=typeof ymaps?s.on("load",t):function(t,e){var a=$("<script/>").attr("src",t).get(0);document.body.appendChild(a),a.onload=function(){e&&e()}}(a.api,t),e}};$.fn.eyMaps=function(t){return methods[t]?methods[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void $.error("Method "+t+" does not exist on jQuery.eyMaps"):(methods.init.apply(this,arguments),this)}}(jQuery);